<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pakistan Air Quality Initiative (PAQI)</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Montserrat:wght@400;600;700&family=Roboto+Mono:wght@700&display=swap" rel="stylesheet">
    
    <style>
        /* --- Design System --- */
        :root {
            --color-primary-blue: #003366;
            --color-secondary-blue: #0ea5e9;
            --color-background-light: #f9fafb;
            --color-background-dark: #1E2A3A;
            --color-text-dark: #333D4A;
            --color-text-light: #FFFFFF;
            --color-border: #DDE1E7;
            
            /* Mapping city colors */
            --color-lahore: #D94743;
            --color-karachi: #F49F0A;
            --color-peshawar: #5E3C99;
            --color-islamabad: #3153A5;
            
            --font-main: 'Poppins', sans-serif;
            --font-heading: 'Montserrat', sans-serif;
            --font-mono: 'Roboto Mono', monospace;
            --transition-curve: cubic-bezier(0.25, 1, 0.5, 1);
            --shadow-subtle: 0 5px 15px rgba(45, 57, 65, 0.05);
            --shadow-lifted: 0 15px 35px rgba(45, 57, 65, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: var(--font-main);
            background-color: var(--color-text-light);
            color: var(--color-text-dark);
            -webkit-font-smoothing: antialiased;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-heading);
            letter-spacing: -0.02em;
            font-weight: 700;
            color: var(--color-primary-blue);
        }

        p {
            font-family: var(--font-main);
            letter-spacing: 0em;
            font-weight: normal;
            color: var(--color-text-dark);
        }

        .container { width: 90%; max-width: 1200px; margin: 0 auto; padding: 100px 0; }
        .section-headline { font-size: clamp(1.5rem, 6vw, 3rem); max-width: 800px; margin: 0 auto 60px auto; text-align: center; font-weight: 500;}

        .animate-on-scroll { opacity: 0; transform: translateY(40px); transition: opacity 1s var(--transition-curve), transform 1s var(--transition-curve); }
        .animate-on-scroll.is-visible { opacity: 1; transform: translateY(0); }
        .delay-1 { transition-delay: 0.1s; } .delay-2 { transition-delay: 0.2s; } .delay-3 { transition-delay: 0.3s; }

        /* --- Sticky Header --- */
        .site-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            
            /* Default padding for the header (large on top, large on bottom) */
            padding: 2rem 0;
            
            /* The transition property now covers padding as well */
            transition: padding 1s ease, box-shadow 1s ease;
            
            /* The border will now be part of the header-container */
            /* We will remove border-bottom: 0.2px solid rgba(255,255,255,0.3); from here */
        }

        .header-scrolled {
            background-color: rgba(220, 220, 220, 0.2);
            backdrop-filter: blur(5px);
            box-shadow: var(--shadow-subtle);
            
            /* Reduced padding for a smaller header when scrolled */
            padding: 0.5rem 0;
        }

        .header-container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            
            display: flex;
            justify-content: space-between;
            align-items: center;
            
            /* Move the border-bottom here. It's better to keep it with the content. */
            border-bottom: 0.2px solid rgba(255,255,255,0.3);
            padding-bottom: 50px;
            transition: border-bottom 0.3s ease; /* Add transition for the border */
        }

        /* We need a new rule to change the border color/thickness when scrolled */
        .header-scrolled .header-container {
            border-bottom: none;
            padding-bottom: 0px;
        }

        @media (max-width: 767px) {
        .header-scrolled .header-logo-text {
            color: var(--color-primary-blue);
            font-size: 1rem;
            transition: color 1s, font-size 1s;
        }

        .header-logo-icon { height: 1.5rem; width: 1.5rem; color: var(--color-secondary-blue); }
        }

        @media (min-width: 768px) { 
            .header-logo-text {
            color: var(--color-primary-blue);
            font-size: 1.5rem;
            } 
        }

        .header-logo { display: flex; align-items: center; gap: 0.5rem; text-decoration: none; }
        .header-logo-icon { height: 2rem; width: 2rem; color: var(--color-secondary-blue); }
        
        /* --- Header Color Change Logic --- */
        .header-logo-text { font-size: 1.5rem; font-weight: 700; color: var(--color-text-light); transition: color 0.3s; }
        .header-scrolled .header-logo-text { color: var(--color-primary-blue); }

        .header-nav { display: none; }
        @media (min-width: 768px) { .header-nav { display: flex; align-items: center; gap: 2rem; } }
        
        .header-nav-link { color: var(--color-text-light); text-decoration: none; font-weight: 300; transition: color 0.3s; }
        .header-scrolled .header-nav-link { color: var(--color-primary-blue); }
        .header-nav-link:hover { color: var(--color-secondary-blue); }
        
        .header-cta { display: none; }
        @media (min-width: 768px) { .header-cta { display: block; background-color: transparent; color: var(--color-text-light); border: 1.5px solid whitesmoke;
            padding: 0.5rem 1.25rem; border-radius: 100px; text-decoration: none; font-weight: 700; transition: all 0.3s; } }
        .header-cta:hover { background-color: var(--color-primary-blue); transform: scale(1.1); border: none;}
        
        .mobile-menu-button { 
            display: block; background: none; border: none; cursor: pointer; padding: 0;
            color: var(--color-text-light); transition: color 0.3s;
        }
        .header-scrolled .mobile-menu-button { color: var(--color-primary-blue); }
        
        .mobile-menu-icon { width: 1.75rem; height: 1.75rem; }
        @media (min-width: 768px) { header.scrolled .mobile-menu-icon { display: block; width: 1.25rem; height: auto;} }
        @media (min-width: 768px) { .mobile-menu-button { display: none; } }
            .mobile-menu { 
                background-color: white; padding: 1rem; border-radius: 8px; 
                box-shadow: var(--shadow-lifted); margin-top: 1rem;
                width: 90%; max-width: 1200px; margin-left: auto; margin-right: auto;
            }
        .mobile-menu.hidden { display: none; }
        .mobile-menu a { display: block; padding: 0.75rem 1rem; color: var(--color-text-dark); text-decoration: none; font-weight: 600; border-radius: 6px; }
        .mobile-menu a:hover { background-color: var(--color-background-light); }


        /* --- Hero Section --- */
        .hero-section {
            height: 100vh;
            position: relative;
            overflow: hidden;
            
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
            padding: 0 1rem; /* Add padding for small screens */
        }

        .hero-slide-container {
        position: absolute;
        inset: 0;
        }

        .hero-slide {
            position: absolute;
            inset: 0;
            background-size: cover;
            background-position: center;
            opacity: 0;
            z-index: 0;
            transform: scale(1);
            transition: opacity 2s ease-in-out, transform 10s ease-in-out;
        }

        .hero-slide.active {
        opacity: 1;
        z-index: 1;
        transform: scale(1.2);
        }

        .is-loaded .hero-slide.active {
            opacity: 1;
            z-index: 1;
            
            /* This is the zoom effect, which will be animated from `scale(1)` */
            transform: scale(1.2);
        }

        .hero-overlay {
        position: absolute;
        inset: 0;
        background-color: rgba(0, 20, 40, 0.6);
        }

        .hero-content {
            position: relative;
            z-index: 10;
            width: 90%;
            max-width: 1200px;
            
            /* Resetting the old positioning */
            margin-top: 0; 
            justify-content: flex-start;
            text-align: left; /* Ensure text inside is left-aligned */
        }

        .hero-text-container {
            max-width: 650px; /* Or a different value like 800px, but less than the hero-content max-width */
            margin: 0; /* Align left */
            width: 100%;
        }

        @media (min-width: 768px) {
            .hero-section {
                padding: 0; /* Remove padding on larger screens */
                align-items: center; /* Re-center content on large screens if desired */
                }
            }
        .hero-content h1 { 
            font-size: clamp(2.5rem, 8vw, 4.5rem); 
            color: var(--color-text-light); 
            margin-left: 0; /* Remove the old fixed margin-left */
            text-align: left;
            font-weight: 500;
        }

        .hero-content p { 
            font-size: clamp(1rem, 3vw, 1.25rem); 
            color: var(--color-text-light); 
            opacity: 0.9; 
            max-width: 700px; 
            margin: 0 0 1rem 0; /* Adjust margin for mobile to align left */
            text-align: left;
        }

        .hero-content .cta-button {
            margin-left: 0; /* Remove the old fixed margin-left */
            text-decoration: none;
            color: #DDE1E7;
        }
        .hero-content .cta-button:hover { transform: translateY(-3px); color: var(--color-primary-blue); font-weight: bolder;}
        
        .hero-nav-links {
            position: absolute;
            bottom: 2.5rem;
            left: 0;
            transform: translateX(-50%);
            z-index: 10;
            width: 90%;
            max-width: 1200px;
            font-weight: 600;
            
            /* These are the key changes for scrollable links */
            display: flex;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch; /* Improved scrolling on iOS */
            white-space: nowrap; /* Prevents wrapping */
            gap: 1rem; /* Adjust space between links */
            padding-bottom: 0.5rem; /* Add some space for the scrollbar */
        }

        /* Ensure individual links don't shrink */
        .hero-nav-links a {
            display: block;
            flex-shrink: 0;
            padding: 0.75rem 0.5rem;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
            overflow-x: auto;
            white-space: nowrap;
            -ms-overflow-style: none;     /* IE 10+ */
            scrollbar-width: none;        /* Firefox */
        }

        .hero-nav-links::-webkit-scrollbar {
            display: none;                /* Chrome, Safari */
        }

        .hero-nav-links a:hover {
            color: white;
            font-weight: bolder;
            border-bottom-color: var(--color-primary-blue);
        }

        /* Remove the old grid styles */
        .hero-nav-grid {
            display: flex;
            gap: 1rem;
        }

        /* Use a media query to apply the original grid layout for tablets and desktops */
       @media (min-width: 768px) {
            .hero-nav-links {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                text-align: left;
            }

            .hero-nav-grid {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* --- Impact Section --- */
        .impact-section { 
            background-color: white; /* Set a light background color for the section */
        }

        /* Adjust the headline to be centered and have a background */
        .impact-section .section-headline {
            font-size: clamp(1.5rem, 6vw, 3rem);
            max-width: 800px;
            margin: 0 auto 60px auto;
            text-align: center;
            color: var(--color-text-dark); /* Ensure it's a dark color */
            
            /* These styles create the "OUR IMPACT" box */
            display: inline-block;
            padding: 0.5rem 1.5rem;
            background-color: var(--color-text-light);
            border: 1px solid var(--color-border);
            border-radius: 9999px; /* This makes it a rounded pill shape */
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 2rem; /* Adjust the margin to space it out from the cards */
        }

        .impact-grid {
            /* Use a fluid grid that wraps on smaller screens */
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Adjusted minmax for slightly wider cards */
            gap: 1.5rem; /* Tighter gap between cards */
            text-align: center;
        }

        .impact-item { 
            /* Base styles for the card */
            padding: 2.5rem 2rem; /* More generous padding inside the card */
            border-radius: 12px; /* Rounded corners */
            color: var(--color-text-light); /* White text for contrast on colored backgrounds */
            box-shadow: var(--shadow-subtle);
            transition: transform 0.3s, box-shadow 0.3s;
            height: 100%; /* Ensure all cards have the same height */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        /* Add some specific colors to match the reference image */
        .impact-item:nth-child(1) { background-color: var(--color-primary-blue); } /* Green */
        .impact-item:nth-child(2) { background-color: var(--color-primary-blue); } /* Yellow */
        .impact-item:nth-child(3) { background-color: var(--color-primary-blue); } /* Blue */
        .impact-item:nth-child(4) { background-color: var(--color-primary-blue); } /* Gray */
        .impact-item:nth-child(5) { background-color: var(--color-primary-blue); } /* Red */
        .impact-item:nth-child(6) { background-color: var(--color-primary-blue); } /* Lighter Gray */


        .impact-item:hover { 
            transform: translateY(-5px); /* Adjusted for a subtler lift */
            box-shadow: var(--shadow-lifted); 
        }

        /* Hide the icon from your original design */
        .impact-item-icon {
            display: none;
        }

        .impact-item-number {
            font-family: var(--font-heading); /* Use the heading font */
            font-size: clamp(2rem, 7vw, 3rem); /* Make the number responsive */
            font-weight: 500; /* Bolder numbers */
            color: inherit; /* Inherit the text color (which is white from the parent) */
            margin-bottom: 0.5rem; 
            line-height: 1; /* Tighter line height for the number */
        }

        .impact-item-text {
            font-size: 1rem;
            color: inherit; /* Inherit the text color (which is white) */
            opacity: 1; /* Remove the opacity for full visibility */
            max-width: 250px; /* Constrain the width of the text inside the card */
            margin: 0;
        }

        /* A separate style for the "More monitors coming soon" headline */
        .impact-section .more-monitors-headline {
            font-size: 24px; font-weight: 300; padding-top: 30px; text-align: center;
            color: var(--color-text-dark);
        }

        .impact-section .more-monitors-headline:hover {
            transform: scale(1.1);
            font-weight: 500;
            color: var(--color-primary-blue);
            transition: 1s;
        }

        /* --- Partners Section --- */
        .partners-section { padding: 80px 0; overflow: hidden; text-align: center; }
        .partners-slider { display: flex; overflow: hidden; max-width: 100%; -webkit-mask-image: linear-gradient(to right, transparent, black 20%, black 80%, transparent); mask-image: linear-gradient(to right, transparent, black 20%, black 80%, transparent); }
        .slide-track { display: flex; gap: 80px; will-change: transform; animation: scroll 17s linear infinite; }
        .slide-track:hover { animation-play-state: paused; }
        .slide { width: auto; height: 100px; display: flex; align-items: center; justify-content: center; flex: 0 0 auto; }
        .partner-logo { max-height: 50px; width: auto; filter: grayscale(100%); opacity: 0.7; transition: all 0.3s; }
        .partner-logo:hover { filter: grayscale(0); opacity: 1; transform: scale(1.1); }
        @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

        /* --- Map Section --- */
        .map-section { background-color: var(--color-background-dark); padding: 100px 0; }
        .map-section .section-headline { color: var(--color-text-light); }
        .map-grid { display: grid; grid-template-columns: 1fr; gap: 3rem; align-items: center; }
        @media (min-width: 768px) { .map-grid { grid-template-columns: 1fr 1fr; } }
        .map-legend p { color: var(--color-text-light); opacity: 0.8; margin-bottom: 1.5rem; }
        .map-legend-items { display: flex; flex-wrap: wrap; gap: 1rem; }
        .legend-item { display: flex; align-items: center; font-size: 0.9rem; color: var(--color-text-light); }
        .legend-color-box { width: 1rem; height: 1rem; border-radius: 4px; margin-right: 0.5rem; }
        .map-container { position: relative; max-width: 500px; margin: 0 auto; }
        .map-image { display: block; width: 100%; height: auto; filter: brightness(0.9) contrast(1.1); }
        .map-marker { position: absolute; width: 20px; height: 20px; transform: translate(-50%, -50%); cursor: pointer; }
        .map-marker::before, .map-marker::after { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 50%; }
        .map-marker::before { width: 100%; height: 100%; border: 2px solid var(--marker-color); animation: pulse 2.5s infinite; }
        .map-marker::after { width: 8px; height: 8px; background-color: var(--marker-color); transition: transform 0.3s var(--transition-curve); }
        .map-marker:hover::after { transform: translate(-50%, -50%) scale(1.4); }
        @keyframes pulse { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(2); opacity: 0; } }
        .map-tooltip { position: absolute; background: rgba(255,255,255,0.98); backdrop-filter: blur(8px); color: var(--color-text-dark); padding: 10px 15px; border-radius: 8px; box-shadow: var(--shadow-lifted); border: 1px solid var(--color-border); width: 240px; text-align: left; pointer-events: none; opacity: 0; transform: translateY(10px) scale(0.95); transition: opacity 0.3s, transform 0.3s; transform-origin: bottom center; }
        .map-tooltip.is-visible { opacity: 1; transform: translateY(0) scale(1); }
        .map-tooltip h4 { font-size: 1rem; margin-bottom: 4px; }
        .map-tooltip p { font-size: 0.9rem; color: var(--color-text-dark); margin: 0; }
        .map-tooltip .aqi-value { font-weight: 700; font-size: 1.1rem; }

        /* --- Data Chart Section --- */
        .dataviz-section { overflow: hidden; background: var(--color-background-light); }
        .chart-grid { display: grid; grid-template-columns: 1fr; gap: 3rem; align-items: center; }
        @media (min-width: 768px) { .chart-grid { grid-template-columns: 1fr 1fr; } }
        .chart-container { background: var(--color-text-light); padding: 2rem; border-radius: 16px; box-shadow: var(--shadow-subtle); }
        .chart-header p { font-size: 1rem; max-width: 600px; opacity: 0.7; }
        .chart-svg-container { position: relative; }
        .chart-svg { overflow: visible; }
        .chart-svg .grid-line { stroke: var(--color-border); }
        .chart-svg .axis-text { font-family: var(--font-main); fill: var(--color-text-dark); opacity: 0.6; font-size: 12px; }
        .chart-svg .data-line { fill: none; stroke-width: 3; stroke-linecap: round; stroke-linejoin: round; transition: opacity 0.4s var(--transition-curve); }
        
        /* --- Blog Section --- */
        .blog-section {
            background-color: var(--color-text-light);
        }

        .blog-section .section-headline {
            /* Existing headline styles from before, plus new ones */
            font-size: clamp(1.5rem, 6vw, 3rem);
            max-width: 1200px;
            margin: 0 auto 60px auto;
            text-align: center;
            position: relative; /* This is crucial for positioning the pseudo-elements */
            display: flex; /* Using flexbox to align the text and lines */
            align-items: center; /* Vertically center the text and lines */
            justify-content: center; /* Horizontally center the text and lines */
        }

        /* Style the horizontal line before the text */
        .blog-section .section-headline::before {
            content: ''; /* Required for pseudo-elements */
            flex-grow: 1; /* This makes the line expand to fill available space */
            height: 1px; /* The thickness of the line */
            background-color: var(--color-border); /* The color of the line */
            margin-right: 1rem; /* Space between the line and the text */
        }

        /* Style the horizontal line after the text */
        .blog-section .section-headline::after {
            content: ''; /* Required for pseudo-elements */
            flex-grow: 1; /* This makes the line expand to fill available space */
            height: 1px; /* The thickness of the line */
            background-color: var(--color-border); /* The color of the line */
            margin-left: 1rem; /* Space between the text and the line */
        }

        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }
        .blog-card { background: white; border-radius: 12px; box-shadow: var(--shadow-subtle); overflow: hidden; transition: transform 0.3s, box-shadow 0.3s; }
        .blog-card:hover { transform: translateY(-8px); box-shadow: var(--shadow-lifted); }
        .blog-card-image-wrapper { overflow: hidden; height: 200px; }
        .blog-card-image { width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s; }
        .blog-card:hover .blog-card-image { transform: scale(1.05); }
        .blog-card-content { padding: 1.5rem; text-decoration: none;}
        .blog-card-content h3 { font-size: 1.25rem; margin-bottom: 0.5rem; transition: color 0.3s; text-decoration: none;}
        .blog-card:hover h3 { color: var(--color-secondary-blue); }
        .blog-card-content p { font-size: 0.95rem; margin-bottom: 1rem; opacity: 0.8; text-decoration: none;}
        .blog-card-link { font-weight: 700; color: var(--color-primary-blue); text-decoration: none; }

        /* --- Team Section --- */
        .team-section { background-color: inherit; }
        .team-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 2rem; }
        .team-card { text-align: center; transition: transform 0.3s; }
        .team-card:hover { transform: scale(1.05); }
        .team-card-image { width: 140px; height: 140px; border-radius: 50%; object-fit: cover; margin: 0 auto 1rem auto; box-shadow: 0 0 0 4px white, var(--shadow-lifted); }
        .team-card h4 { font-size: 1.2rem; margin-bottom: 0.25rem; }
        .team-card p { font-size: 0.9rem; color: var(--color-secondary-blue); opacity: 1; }

        /* --- Footer --- */
        .site-footer { background: var(--color-primary-blue); color: rgba(255, 255, 255, 0.7); padding: 25px 0; margin-bottom: -75px;}
        .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; }
        .footer-col h4 { color: white; font-size: 1.1rem; margin-bottom: 1rem; }
        .footer-col p, .footer-col a { font-size: 0.9rem; color: rgba(255, 255, 255, 0.7); text-decoration: none; }
        .footer-col a:hover { color: white; }
        .footer-col ul { list-style: none; space-y: 0.5rem; }
        .footer-socials { display: flex; gap: 1rem; margin-top: 1rem; }
        .footer-socials a { color: rgba(255, 255, 255, 0.7); }
        .footer-socials a:hover { color: white; }
        .footer-subscribe-form { display: flex; margin-top: 1rem; }
        .footer-subscribe-form input { width: 100%; border: none; padding: 0.75rem; border-radius: 6px 0 0 6px; background: rgba(255,255,255,0.1); color: white; }
        .footer-subscribe-form input::placeholder { color: rgba(255,255,255,0.5); }
        .footer-subscribe-form button { border: none; background: var(--color-secondary-blue); color: white; padding: 0.75rem 1rem; border-radius: 0 6px 6px 0; cursor: pointer; font-weight: 700; }
        .footer-bottom { margin-bottom: -30px; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.2); text-align: center; font-size: 0.9rem; }
    </style>
</head>
<body>

    <header class="site-header" id="main-header">
        <div class="header-container">
            <a href="#" class="header-logo">
                <img class="header-logo-icon" src="logo.png" />
                <span class="header-logo-text">Pakistan Air Quality Initiative</span>
            </a>
            <nav class="header-nav">
                <a href="#impact" class="header-nav-link">Impact</a>
                <a href="#map" class="header-nav-link">Map</a>
                <a href="#chart" class="header-nav-link">Data</a>
                <a href="#blog" class="header-nav-link">Our Insights</a>
                <a href="#team" class="header-nav-link">Our Team</a>
            </nav>
            <a href="#footer" class="header-cta">Let's Chat</a>
            <button id="mobile-menu-button" class="mobile-menu-button">
                <svg class="mobile-menu-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </div>
        <div id="mobile-menu" class="mobile-menu hidden"></div>
    </header>

    <main>
        <section id="hero" class="hero-section">
            <!-- Background Slides -->
            <div class="hero-slide-container">
                <div id="slide-1" class="hero-slide active" style="background-image: url('pic1.png');"></div>
                <div id="slide-2" class="hero-slide" style="background-image: url('pic2.png');"></div>
                <div id="slide-3" class="hero-slide" style="background-image: url('pic3.jpeg');"></div>
                <div id="slide-4" class="hero-slide" style="background-image: url('pic4.jpg');"></div>
            </div>

            <!-- Overlay -->
            <div class="hero-overlay"></div>

            <!-- Hero Text -->
            <div id="hero-text-content" class="hero-content">
                <div class="hero-text-container">
                    <h1>Clearing the Air for a Healthier Pakistan</h1>
                    <p>Air pollution is the nation's leading environmental threat. We are dedicated to providing the data and tools needed to drive change.</p>
                    <a href="#impact" class="cta-button">Learn About The Crisis &rarr;</a>
                </div>
            </div>
        </section>

        <!-- Nav links below hero -->
        <div class="hero-nav-links">
            <div class="hero-nav-grid">
                <a href="#impact" class="hero-nav-link">Our Impact</a>
                <a href="#map" class="hero-nav-link">Interactive Map</a>
                <a href="#chart" class="hero-nav-link">Latest Data</a>
                <a href="#partners" class="hero-nav-link">Our Partners</a>
            </div>
        </div>

        <section id="impact" class="impact-section container">
            <h2 class="section-headline animate-on-scroll">Our Data-Driven Impact</h2>
            <div class="impact-grid">
                <div class="impact-item animate-on-scroll">
                    <div class="impact-item-number">150+</div>
                    <p class="impact-item-text">Monitoring Stations</p>
                </div>
                <div class="impact-item animate-on-scroll delay-1">
                    <div class="impact-item-number">2M+</div>
                    <p class="impact-item-text">People Reached</p>
                </div>
                <div class="impact-item animate-on-scroll delay-2">
                    <div class="impact-item-number">7.5K+</div>
                    <p class="impact-item-text">Social Media Followers</p>
                </div>
            </div>
            <div style="padding-top: 120px; text-align: center;">
                <svg width="80" height="auto" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" >
                    <path fill="gray" d="M177.8 63.2l10 17.4c2.8 4.8 4.2 10.3 4.2 15.9v41.4c0 3.9 1.6 7.7 4.3 10.4c6.2 6.2 16.5 5.7 22-1.2l13.6-17c4.7-5.9 12.9-7.7 19.6-4.3l15.2 7.6c3.4 1.7 7.2 2.6 11 2.6c6.5 0 12.8-2.6 17.4-7.2l3.9-3.9c2.9-2.9 7.3-3.6 11-1.8l29.2 14.6c7.8 3.9 12.6 11.8 12.6 20.5c0 10.5-7.1 19.6-17.3 22.2l-35.4 8.8c-7.4 1.8-15.1 1.5-22.4-.9l-32-10.7c-3.3-1.1-6.7-1.7-10.2-1.7c-7 0-13.8 2.3-19.4 6.5L176 212c-10.1 7.6-16 19.4-16 32v28c0 26.5 21.5 48 48 48h32c8.8 0 16 7.2 16 16v48c0 17.7 14.3 32 32 32c10.1 0 19.6-4.7 25.6-12.8l25.6-34.1c8.3-11.1 12.8-24.6 12.8-38.4V318.6c0-3.9 2.6-7.3 6.4-8.2l5.3-1.3c11.9-3 20.3-13.7 20.3-26c0-7.1-2.8-13.9-7.8-18.9l-33.5-33.5c-3.7-3.7-3.7-9.7 0-13.4c5.7-5.7 14.1-7.7 21.8-5.1l14.1 4.7c12.3 4.1 25.7-1.5 31.5-13c3.5-7 11.2-10.8 18.9-9.2l27.4 5.5C432 112.4 351.5 48 256 48c-27.7 0-54 5.4-78.2 15.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z"></path>
                </svg>
            </div>
            <h2 class="more-monitors-headline animate-on-scroll"> More monitors coming soon... </h2>
        </section>

        <section id="partners" class="partners-section">
            <h2 class="section-headline animate-on-scroll" style="margin-bottom: 20px;">Stronger Together</h2>
            <p style="margin-bottom: 30px;">We collaborate with leading organizations to maximize our impact and drive systemic change.</p>
            <div class="partners-slider">
                <div class="slide-track">
                    <div class="slide"><img class="partner-logo" src="iqair.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="breathepak.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="lums.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="lei.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="uol.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="wwf.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="umt.png" alt="Partner Logo" /></div>
                    <!-- Duplicates for seamless loop -->
                    <div class="slide"><img class="partner-logo" src="iqair.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="breathepak.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="lums.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="lei.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="uol.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="wwf.png" alt="Partner Logo" /></div>
                    <div class="slide"><img class="partner-logo" src="umt.png" alt="Partner Logo" /></div>
                </div>
            </div>
        </section>

        <section id="map" class="map-section">
            <div class="container">
                <div class="map-grid">
                    <div class="map-legend animate-on-scroll">
                        <h2 class="section-headline" style="text-align: left; color: white;">Live Air Quality Across Pakistan</h2>
                        <p>Our network provides a real-time snapshot of the air quality in major urban centers. Explore the map to see the current annual average PM₂.₅ levels.</p>
                        <div class="map-legend-items">
                            <div class="legend-item"><span class="legend-color-box" style="background-color: #22c55e;"></span> Good</div>
                            <div class="legend-item"><span class="legend-color-box" style="background-color: #facc15;"></span> Moderate</div>
                            <div class="legend-item"><span class="legend-color-box" style="background-color: #f97316;"></span> Unhealthy (SG)</div>
                            <div class="legend-item"><span class="legend-color-box" style="background-color: #ef4444;"></span> Unhealthy</div>
                            <div class="legend-item"><span class="legend-color-box" style="background-color: #a855f7;"></span> Very Unhealthy</div>
                        </div>
                    </div>
                    <div class="map-container animate-on-scroll delay-1">
                        <img src="pak.png" class="map-image" alt="Map of Pakistan with AQI hotspots">
                        <div id="map-interactive-layer"></div>
                        <div id="map-tooltip" class="map-tooltip"></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="chart" class="dataviz-section">
            <div class="container">
                <div class="chart-grid">
                     <div class="order-2 md:order-1 animate-on-scroll">
                        <h2 class="section-headline" style="text-align: left;">A Decade of Data</h2>
                        <p style="text-decoration: none; margin-bottom: 15px;" class="chart-header-p">Our network has chronicled the air quality crisis across Pakistan. While yearly fluctuations exist, the trend is clear: annual pollution levels remain dangerously high, consistently exceeding WHO safe limits.</p>
                        <a href="#" style="color: var(--color-primary-blue); font-weight: 700; text-decoration: none;">Download Full Report &rarr;</a>
                    </div>
                    <div class="chart-container order-1 md:order-2 animate-on-scroll delay-1">
                        <div class="chart-svg-container"><svg id="timeline-chart" class="chart-svg" viewBox="0 0 800 400"></svg></div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="blog" class="blog-section container">
            <h2 class="section-headline animate-on-scroll">Our Latest Insights</h2>
            <div class="blog-grid">
                <a href="#" class="blog-card animate-on-scroll">
                    <div class="blog-card-image-wrapper"><img src="airpurifier.jpg" alt="Air purifier" class="blog-card-image"></div>
                    <div class="blog-card-content">
                        <h3>How to Choose the Right Air Purifier</h3>
                        <p style="text-decoration: none;">A practical guide to understanding HEPA filters, CADR ratings, and finding the perfect device for your space.</p>
                        <span class="blog-card-link">Read More &rarr;</span>
                    </div>
                </a>
                <a href="#" class="blog-card animate-on-scroll delay-1">
                    <div class="blog-card-image-wrapper"><img src="traffic.jpg" alt="Traffic in a city" class="blog-card-image"></div>
                    <div class="blog-card-content">
                        <h3>Policy on Vehicular Emissions</h3>
                        <p>Our latest recommendations for the government to tackle traffic pollution, one of the largest sources of smog.</p>
                        <span class="blog-card-link">Read More &rarr;</span>
                    </div>
                </a>
                <a href="#" class="blog-card animate-on-scroll delay-2">
                    <div class="blog-card-image-wrapper"><img src="community.jpg" alt="Community meeting" class="blog-card-image"></div>
                    <div class="blog-card-content">
                        <h3>Community Spotlight: Citizens Fighting Back</h3>
                        <p style="text-decoration: none;">How a neighborhood used our data to advocate for green spaces and reduce local industrial pollution.</p>
                        <span class="blog-card-link">Read More &rarr;</span>
                    </div>
                </a>
            </div>
        </section>

        <section id="team" class="team-section container">
            <h2 class="section-headline animate-on-scroll">The People Behind the Data</h2>
            <div class="team-grid">
                <div class="team-card animate-on-scroll"><img src="Abid.jpeg" alt="Abid" class="team-card-image"><h4>Abid Omar</h4><p>Lead Atmospheric Scientist</p></div>
                <div class="team-card animate-on-scroll delay-1"><img src="Dawar.jpg" alt="Bilal Ahmed" class="team-card-image"><h4>Dawar Butt</h4><p>Head of Engineering</p></div>
                <div class="team-card animate-on-scroll delay-2"><img src="Mahad.jpeg" alt="Fatima Raza" class="team-card-image"><h4>Mahad Naveed</h4><p>Data & Policy Analyst</p></div>
                <div class="team-card animate-on-scroll delay-3"><img src="https://placehold.co/200x200/e2e8f0/334155?text=SM" alt="Saad Malik" class="team-card-image"><h4>Mariam Shah</h4><p>Community Outreach Lead</p></div>
            </div>
        </section>
    </main>

    <footer class="site-footer">
        <div class="container" style="padding-top: 5rem; padding-bottom: 4rem;">
            <div class="footer-grid">
                <div class="footer-col">
                    <h4>About PAQI</h4>
                    <p>The Pakistan Air Quality Initiative is a data-driven, research thinktank dedicated to providing open, real-time air quality data to empower citizens and drive policy change.</p>
                    <div class="footer-socials">
                        <a href="#"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M22.675 0h-21.35C.59 0 0 .59 0 1.325v21.35C0 23.41.59 24 1.325 24H12.82v-9.29H9.692v-3.622h3.128V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116c.735 0 1.325-.59 1.325-1.325V1.325C24 .59 23.41 0 22.675 0z"></path></svg></a>
                        <a href="#"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.223.085a4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.213 0-.425-.015-.637A9.935 9.935 0 0024 4.59z"></path></svg></a>
                        <a href="#"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 114.128 0c0 1.14-.926 2.065-2.065 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.225 0z"></path></svg></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Navigate</h4>
                    <ul>
                        <li><a href="#impact">Impact</a></li>
                        <li><a href="#map">Live Map</a></li>
                        <li><a href="#chart">Data & Charts</a></li>
                        <li><a href="#team">Our Team</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Resources</h4>
                     <ul>
                        <li><a href="#blog">Insights</a></li>
                        <li><a href="#">Research Papers</a></li>
                        <li><a href="#">Press Kit</a></li>
                        <li><a href="#">Contact Us</a></li>
                    </ul>
                </div>
                 <div class="footer-col">
                    <h4>Subscribe</h4>
                    <p>Get the latest air quality news and health advisories.</p>
                    <form class="footer-subscribe-form">
                        <input type="email" placeholder="Your email">
                        <button type="submit">Go</button>
                    </form>
                </div>
            </div>
            <div class="footer-bottom">
                <p style="color: #DDE1E7;">&copy; 2025 Pakistan Air Quality Initiative. All Rights Reserved. | <a style="color: #0ea5e9;" href="#">Privacy Policy</a></p>
            </div>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Header & Mobile Menu Logic ---
        const header = document.getElementById('main-header');
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const desktopNav = document.querySelector('.header-nav');
        
        mobileMenu.innerHTML = desktopNav.innerHTML; // Clone nav for mobile
        
        window.addEventListener('scroll', () => {
            header.classList.toggle('header-scrolled', window.scrollY > 50);
        });

        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // --- Hero Slider Logic ---
        const slides = [
            {
            id: 'slide-1',
            title: 'Clearing the Air for a Healthier Pakistan',
            text: "Air pollution is the nation's leading environmental threat. We are dedicated to providing the data and tools needed to drive change.",
            button: 'Learn About The Crisis &rarr;',
            },
            {
            id: 'slide-2',
            title: 'Data-Driven Action, Real-Time Impact',
            text: 'Our network of over 100 sensors across Pakistan provides transparent, real-time air quality data to citizens, researchers, and policymakers.',
            button: 'View Our Live Map &rarr;',
            },
            {
            id: 'slide-3',
            title: 'Protecting Our Future Generations',
            text: 'Every citizen deserves the right to breathe clean air. Our initiatives focus on public health awareness and safeguarding vulnerable communities.',
            button: 'See Our Impact &rarr;',
            },
            {
            id: 'slide-4',
            title: 'A Breath of Fresh Air is Possible',
            text: 'Through collaborative effort, scientific research, and public engagement, we can build a future with clear skies for Pakistan.',
            button: 'Get Involved &rarr;',
            },
        ];

        let currentSlide = 0;
        const heroTextContent = document.getElementById('hero-text-content');

        const initialSlide = document.getElementById(slides[currentSlide].id);
        if (initialSlide) {
        setTimeout(() => {
            initialSlide.classList.remove('is-initial');
        }, 100); // A small delay to ensure the initial zoom animation starts
        }

        function changeSlide() {
            // Hide previous slide
            document.getElementById(slides[currentSlide].id).classList.remove('active');

            // Update index
            currentSlide = (currentSlide + 1) % slides.length;

            // Show new slide
            document.getElementById(slides[currentSlide].id).classList.add('active');

            // Animate text
            heroTextContent.style.opacity = '0';
            setTimeout(() => {
            const slideData = slides[currentSlide];
            heroTextContent.innerHTML = `
                <div class="hero-text-container">
                    <h1>${slideData.title}</h1>
                    <p>${slideData.text}</p>
                    <a href="#map" class="cta-button">${slideData.button}</a>
                </div>
            `;
            heroTextContent.style.opacity = '1';
            heroTextContent.style.transition = 'opacity 1s ease-in-out';
            }, 800);
        }

        setInterval(changeSlide, 6000);

        // --- General Animation Observer ---
        const animationObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) entry.target.classList.add('is-visible');
            });
        }, { threshold: 0.1 });
        document.querySelectorAll('.animate-on-scroll').forEach(el => animationObserver.observe(el));
        
        // --- Data for Map & Chart ---
        const chartData = {
            Lahore: {"2017":196.27,"2018":117.98,"2019":100.02,"2020":83.10,"2021":90.99,"2022":107.97,"2023":105.91,"2024":104.58},
            Karachi: {"2017":38.83,"2018":47.92,"2019":37.75,"2020":54.27,"2021":58.19,"2022":48.69,"2023":52.20,"2024":46.22},
            Peshawar: {"2017":62.54,"2018":76.79,"2019":64.74,"2020":43.87,"2021":101.25,"2022":95.92,"2023":84.01,"2024":95.78},
            Islamabad: {"2017":41.78,"2018":44.07,"2019":42.38,"2020":44.42,"2021":47.00,"2022":41.79,"2023":51.11,"2024":54.41}
        };

        const cityColors = { Lahore: 'var(--color-lahore)', Karachi: 'var(--color-karachi)', Peshawar: 'var(--color-peshawar)', 'Islamabad': 'var(--color-islamabad)' };

        // --- SVG Chart Logic ---
        const svg = document.getElementById('timeline-chart');
        if (svg) {
            const years = Array.from({length: 8}, (_, i) => 2017 + i);
            const margin = {top: 20, right: 20, bottom: 30, left: 60}, width = 800 - margin.left - margin.right, height = 400 - margin.top - margin.bottom;
            const yMax = 200;
            const xScale = (year) => margin.left + (years.indexOf(year) / (years.length - 1)) * width;
            const yScale = (value) => margin.top + height - (value / yMax) * height;

            const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
            years.forEach((year, i) => {
                if (i % 1 === 0) {
                    const tick = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    tick.setAttribute('x', xScale(year)); tick.setAttribute('y', height + margin.top + 20);
                    tick.setAttribute('class', 'axis-text'); tick.setAttribute('text-anchor', 'middle');
                    tick.textContent = year; g.appendChild(tick);
                }
            });
            [0, 5, 50, 100, 150, 200].forEach(val => {
                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute('x1', margin.left); line.setAttribute('x2', width + margin.left);
                line.setAttribute('y1', yScale(val)); line.setAttribute('y2', yScale(val));
                line.setAttribute('class', 'grid-line');
                if (val === 5) line.setAttribute('stroke-dasharray', '4 4');
                g.appendChild(line);
                const label = document.createElementNS("http://www.w3.org/2000/svg", "text");
                label.setAttribute('x', margin.left - 15); label.setAttribute('y', yScale(val) + 4);
                label.setAttribute('class', 'axis-text'); label.setAttribute('text-anchor', 'end');
                label.textContent = val;
                if (val === 5) { label.textContent = '5 (WHO)'; label.setAttribute('font-weight', 'bold'); }
                g.appendChild(label);
            });
            svg.appendChild(g);

            Object.keys(chartData).forEach(city => {
                const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                const points = years.map(year => chartData[city][year] !== undefined ? `${xScale(year)},${yScale(chartData[city][year])}` : null).filter(p => p).join(' ');
                path.setAttribute('d', `M ${points}`); path.setAttribute('class', 'data-line');
                path.id = `line-${city}`; path.style.stroke = cityColors[city];
                path.style.strokeDasharray = path.getTotalLength(); path.style.strokeDashoffset = path.getTotalLength();
                svg.appendChild(path);
            });

            new IntersectionObserver((entries) => {
                if (entries[0].isIntersecting) {
                    Object.keys(chartData).forEach((city, i) => {
                        const path = document.getElementById(`line-${city}`);
                        path.style.transition = `stroke-dashoffset 2s ${i * 0.15}s var(--transition-curve)`;
                        path.style.strokeDashoffset = '0';
                    });
                }
            }, { threshold: 0.6 }).observe(svg);


            // Legend
            const legend = document.createElementNS("http://www.w3.org/2000/svg", "g");

            const legendPadding = 10;
            const legendItemSpacing = 120;
            const legendY = margin.top - 20; // vertical position of legend
            const cityNames = Object.keys(chartData);

            // Calculate total width of the legend
            const totalLegendWidth = (cityNames.length - 1) * legendItemSpacing + cityNames.length * 60;
            const legendStartX = (margin.left + width / 2) - (totalLegendWidth / 2);

            cityNames.forEach((city, i) => {
                const x = legendStartX + i * (legendItemSpacing + 30);

                // Circle marker
                const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                circle.setAttribute('cx', x + 8);
                circle.setAttribute('cy', legendY);
                circle.setAttribute('r', 6);
                circle.setAttribute('fill', cityColors[city]);
                legend.appendChild(circle);

                // Text label
                const label = document.createElementNS("http://www.w3.org/2000/svg", "text");
                label.setAttribute('x', x + 20);
                label.setAttribute('y', legendY + 4);
                label.setAttribute('class', 'axis-text');
                label.textContent = city;
                legend.appendChild(label);
            });

            svg.appendChild(legend);

            const yAxisLabel = document.createElementNS("http://www.w3.org/2000/svg", "text");
            yAxisLabel.setAttribute("transform", `rotate(-90)`);
            yAxisLabel.setAttribute("x", -height / 2);  // center along y-axis
            yAxisLabel.setAttribute("y", 15);  // distance from y-axis
            yAxisLabel.setAttribute("text-anchor", "middle");
            yAxisLabel.setAttribute("class", "axis-text");
            yAxisLabel.textContent = "PM2.5 Concentration (µg/m³)";

            svg.appendChild(yAxisLabel);
        }
        
        // --- PNG Map Logic ---
        const mapLayer = document.getElementById('map-interactive-layer');
        const mapTooltip = document.getElementById('map-tooltip');
        if (mapLayer) {
            const mapCityData = {
                'Islamabad': { top: '30%', left: '68%', aqi: Math.round(chartData['Islamabad']['2024']), color: cityColors['Karachi'] },
                'Lahore': { top: '45%', left: '72.5%', aqi: Math.round(chartData['Lahore']['2024']), color: cityColors['Lahore'] },
                'Peshawar': { top: '26%', left: '61%', aqi: Math.round(chartData['Peshawar']['2024']), color: cityColors['Lahore'] },
                'Karachi': { top: '90%', left: '45%', aqi: Math.round(chartData['Karachi']['2024']), color: cityColors['Karachi'] },
            };
            Object.keys(mapCityData).forEach(city => {
                const data = mapCityData[city];
                const marker = document.createElement('div');
                marker.className = 'map-marker';
                marker.dataset.city = city;
                marker.style.top = data.top;
                marker.style.left = data.left;
                marker.style.setProperty('--marker-color', data.color);
                mapLayer.appendChild(marker);
            });

            document.querySelectorAll('.map-marker').forEach(marker => {
                marker.addEventListener('mouseenter', e => {
                    const city = e.currentTarget.dataset.city;
                    const data = mapCityData[city];
                    let level = 'Good';
                    if (data.aqi > 5) level = 'Moderate'; 
                    if (data.aqi > 35) level = 'Unhealthy for Sensitive Groups'; 
                    if (data.aqi > 55) level = 'Unhealthy';

                    mapTooltip.innerHTML = `<h4>${city}</h4><p>2024 Annual Avg: <span class="aqi-value" style="color:${data.color};">${data.aqi}</span> µg/m³</p><small>${level}</small>`;
                    mapTooltip.style.left = `${e.currentTarget.offsetLeft - mapTooltip.offsetWidth / 2 + e.currentTarget.offsetWidth / 2}px`;
                    mapTooltip.style.top = `${e.currentTarget.offsetTop - mapTooltip.offsetHeight - 15}px`;
                    mapTooltip.classList.add('is-visible');
                });
                marker.addEventListener('mouseleave', () => mapTooltip.classList.remove('is-visible'));
            });
        }
    });
    </script>
</body>
</html>
